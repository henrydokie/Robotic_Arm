#include <Servo.h>

Servo myServo;

const int currentPin = A0; // Pin connected to the current sensor
const float sensitivity = 0.185; // ACS712 sensitivity (185mV per Amp for 5A version)
const float offset = 2.5; // Offset voltage at 0 current (in volts)
const int servoPin = 9;

void setup() {
  Serial.begin(9600);
  myServo.attach(servoPin);
  Serial.println("Waveform Display Setup Initialized");
}

void loop() {
  // Move the servo to random positions
  for (int angle = 0; angle <= 180; angle += 30) {
    myServo.write(angle);
    delay(500);

    // Measure current
    int rawValue = analogRead(currentPin);
    float voltage = (rawValue / 1024.0) * 5.0; // Convert to voltage (5V reference)
    float current = (voltage - offset) / sensitivity; // Calculate current in Amps

    // Send data to Serial for plotting
    Serial.print("Angle: ");
    Serial.print(angle);
    Serial.print(", Current: ");
    Serial.println(current, 3); // Display current with 3 decimal places
  }
}
